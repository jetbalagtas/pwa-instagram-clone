window.setImmediate||function(){"use strict";var n=0,t={},e=!0,r=Array.prototype.slice,i="setImmediatePolyfillMessage";function o(n){var e,o=n.data;"string"==typeof o&&0==o.indexOf(i)&&(e=t[o])&&(delete t[o],function(n){var t=n[0];switch(n.length){case 1:return t();case 2:return t(n[1]);case 3:return t(n[1],n[2])}t.apply(window,r.call(n,1))}(e))}window.setImmediate=function(){for(var r=n++,u=i+r,c=arguments.length,f=new Array(c);c--;)f[c]=arguments[c];return t[u]=f,e&&(e=!1,window.addEventListener("message",o)),window.postMessage(u,"*"),r},window.clearImmediate=function(n){delete t[i+n]}}(),function(n){"use strict";var t="[[PromiseStatus]]",e="[[PromiseValue]]",r="[[OnFulfilled]]",i="[[OnRejected]]",o="[[OriginalError]]",u="pending",c="internal pending",f="fulfilled",a="rejected",s='constructor Promise requires "new".',l="then() cannot return same Promise that it resolves.",d=n.setImmediate||require("timers").setImmediate,h=Array.isArray||function(n){return"[object Array]"==Object.prototype.toString.call(n)};function w(n){this[o]=n}function m(n){return n instanceof w}function p(n){return"function"==typeof n}function y(n){return n instanceof A}function v(n){return n}function g(n){throw n}function P(n){delete n[r],delete n[i]}function j(n){var t,e=n.length;for(t=0;t<e;t++)n[t]()}function E(n,t,e){var r=I(e);y(r)?r.then(n,t):m(r)?t(r[o]):n(e)}function I(n){var t;if(y(n))return n;if(function(n){return Object(n)===n}(n)){try{t=n.then}catch(n){return new w(n)}if(p(t))return new A(function(e,r){d(function(){try{t.call(n,e,r)}catch(n){r(n)}})})}return null}function O(n,i){function a(e){n[t]==u&&b(n,e)}try{i(function(i){n[t]==u&&function n(i,u){var a,s=I(u);y(s)?(i[t]=c,s.then(function(t){n(i,t)},function(n){b(i,n)})):m(s)?b(i,s[o]):(i[t]=f,i[e]=u,(a=i[r])&&a.length&&(P(i),j(a)))}(n,i)},a)}catch(n){a(n)}}function b(n,r){var o=n[i];n[t]=a,n[e]=r,o&&o.length&&(P(n),j(o))}function A(n){if(!y(this))throw new TypeError(s);this[t]=u,this[e]=void 0,O(this,n)}A.prototype.then=function(n,o){var u,c=this;return n=p(n)?n:v,o=p(o)?o:g,u=new A(function(s,h){function w(n){var t;try{t=n(c[e])}catch(n){return void h(n)}t===u?h(new TypeError(l)):E(s,h,t)}function m(){d(w,n)}function p(){d(w,o)}switch(c[t]){case f:m();break;case a:p();break;default:!function(n,t,e){n[r]||(n[r]=[],n[i]=[]),n[r].push(t),n[i].push(e)}(c,m,p)}})},A.prototype.catch=function(n){return this.then(v,n)},A.resolve=function(n){var t=I(n);return y(t)?t:new A(function(e,r){m(t)?r(t[o]):e(n)})},A.reject=function(n){return new A(function(t,e){e(n)})},A.race=function(n){return new A(function(t,e){var r,i;if(h(n))for(i=n.length,r=0;r<i;r++)E(t,e,n[r]);else e(new TypeError("not an array."))})},A.all=function(n){return new A(function(t,e){var r,i,u,c,f=0,a=0;if(h(n)){for(i=(n=n.slice(0)).length,c=0;c<i;c++)y(r=I(u=n[c]))?(a++,r.then(function(e){return function(r){n[e]=r,++f==a&&t(n)}}(c),e)):m(r)?e(r[o]):n[c]=u;a||t(n)}else e(new TypeError("not an array."))})},"undefined"!=typeof module&&module.exports?module.exports=n.Promise||A:n.Promise||(n.Promise=A)}(this);